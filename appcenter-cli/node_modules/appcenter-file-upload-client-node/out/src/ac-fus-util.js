"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.fetchWithOptions = exports.resolveProxySettings = void 0;
const node_fetch_1 = require("node-fetch");
const proxy_agent_1 = require("proxy-agent");
function resolveProxySettings(options = {}) {
    const instanceOptions = Object.assign({}, options);
    const proxyServer = process.env.http_proxy ||
        process.env.HTTP_PROXY ||
        process.env.https_proxy ||
        process.env.HTTPS_PROXY ||
        null;
    if (proxyServer && !proxyServer.startsWith("http://") && !proxyServer.startsWith("https://")) {
        console.warn("Proxy address in environment variable does not start with either 'http://' or 'https://'. CLI might not work correctly.");
    }
    if (!options.agent && proxyServer) {
        instanceOptions.agent = new proxy_agent_1.ProxyAgent({ getProxyForUrl: () => proxyServer });
    }
    return instanceOptions;
}
exports.resolveProxySettings = resolveProxySettings;
function fetchWithOptions(url, options = {}) {
    return (0, node_fetch_1.default)(url, resolveProxySettings(options));
}
exports.fetchWithOptions = fetchWithOptions;
//# sourceMappingURL=ac-fus-util.js.map